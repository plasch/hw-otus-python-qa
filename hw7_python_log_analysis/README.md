# Домашнее задание: Анализ лога веб-сервера

**Цель:**
потренироваться писать парсеры для логов.


### Задание
Написать скрипт анализа приложенного access.log файла.

Формат записи в файле лога:
`%h %t "%r" %>s %b "%{Referer}i" "%{User-Agent}i" %D`

- `%h` - имя удаленного хоста
- `%t`  - время получения запроса 
- `%r`  - тип запроса, его содержимое и версия 
- `%s` -  код состояния HTTP 
- `%b` -  количество отданных сервером байт 
- `%{Referer}` - URL-источник запроса 
- `%{User-Agent}` - HTTP-заголовок, содержащий информацию о запросе 
- `%D` - длительность запроса в миллисекундах

### Требования к реализации

1. Должна быть возможность указать директорий где искать логи или конкретный файл 
2. Должна быть возможность обработки всех логов внутри одного директория (статистика по каждому логу должна выводиться отдельно и должна быть сохранена в отдельном json-файле)
3. Для access.log должна собираться следующая информация:
   1. общее количество выполненных запросов 
   2. количество запросов по HTTP-методам: GET - 20, POST - 10 и т.п. (список необходимых методов можно посмотреть в RFC: https://datatracker.ietf.org/doc/html/rfc7231#section-4)
   3. топ 3 IP адресов, с которых были сделаны запросы 
   4. топ 3 самых долгих запросов, должно быть видно метод, url, ip, длительность, дату и время запроса 
4. Собранная статистика должна быть сохранена в json файл и выведена в терминал в свободном (но понятном) формате

# Скрипт "Анализ лога веб-сервера"

### Скрипт анализа приложенного access.log файла, возможности:
1. Возможно указать директорий, где искать логи или конкретный файл (через аргумент командной строки `-l`)
2. Вся статистика сохраняется в отдельном json-файле и выводится в терминал в удобном формате 
3. Обработка всех логов внутри одного директория 
4. Для `access.log` собирается следующая информация:
   - общее количество выполненных запросов (`total_requests`)
   - количество запросов по HTTP-методам (`total_stat`)
   - топ 3 IP адресcов, с которых были сделаны запросы (`top3_ip_requests`)
   - топ 3 самых долгих запросов c полямии: метод, url, ip, длительность, дату и время запроса (`top3_slowly_requests`)
5. Пример запуска скрипта `python log_parser.py -l access.log`
6. Пример вывода:

```
===== LOG FILE: access.log =====
{
   "total_requests":101,
   "total_stat":{
      "GET":70,
      "POST":31,
      "PUT":0,
      "DELETE":0,
      "HEAD":0,
      "OPTIONS":0
   },
   "top3_ip_requests":{
      "191.182.199.16":{
         "REQUESTS_COUNT":37
      },
      "83.167.113.100":{
         "REQUESTS_COUNT":4
      },
      "109.169.248.247":{
         "REQUESTS_COUNT":2
      }
   },
   "top3_slowly_requests":{
      "95.29.198.15":{
         "METHOD":"POST",
         "URL":"http://almhuette-raith.at/administrator/",
         "DATE":"12/Dec/2015:18:32:11",
         "DURATION":"9865"
      },
      "46.72.213.133":{
         "METHOD":"POST",
         "URL":"http://almhuette-raith.at/administrator/",
         "DATE":"12/Dec/2015:18:39:27",
         "DURATION":"9769"
      },
      "81.88.222.215":{
         "METHOD":"POST",
         "URL":"http://almhuette-raith.at/administrator/",
         "DATE":"12/Dec/2015:19:20:57",
         "DURATION":"9395"
      }
   }
}
```